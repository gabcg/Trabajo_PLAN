---
title: "PLAN"
author: "Gabriel Carbonell, Eduardo Rodr√≠guez, Lucas Naranjo Garc√≠a"
date: "7/3/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introducci√≥n

## C√°lculo de potencia 

Realizamos un experimento piloto con tres r√©plicas iniciales. Cada r√©plica pertenece a un bloque. Cargamos los datos:

```{r}
piloto <- read.csv2("/Users/Lucas/downloads/piloto.csv", header = TRUE, sep = ";")
piloto$Individual <- as.factor(piloto$Individual)
piloto$Device <- as.factor(piloto$Device)
piloto$Type <- as.factor(piloto$Type)
```

A continuaci√≥n, realizamos el c√°lculo de potencia:

En primer lugar calculamos el Delta:

```{r}
piloto.aov <- aov(Count ~ Individual + Device * Type, data = piloto)
summary(piloto.aov)
```

Usamos el sigma=sqrt(mmE) para realizar el c√°lculo de potencia.

#N√∫mero de r√©plicas para efectos principales:
Queremos detectar los efectos principales del dispositivo (2 niveles) y la visibilidad (2 niveles) para Œî = 5 yùúé = 5.24 (sqrt(mmE))

```{r}
library(daewr)
sigma <- sqrt(27.42) ; 
alpha <- .05; 
Delta <- 6; 
nlev <- c(2,2) 
rmin <- 2; 
rmax <- 9; 
nreps <- c(rmin:rmax)
### <b>
power <- Fpower2(alpha, nlev, nreps, Delta, sigma) ### </b>
options(digits = 5)
power
```
#N√∫mero de r√©plicas para interacciones:
Queremos detectar interacciones entre el dispositivo  (2 niveles) y la viibilidad (2 niveles), con Œî = 6 y suponiendo ùúé = 5.24 (lo tratamos como ANOVA de un factor con 2x2=4 niveles):
```{r}
library(daewr)
sigma <- sqrt(27.42) 
alpha <- .05
Delta <- 6
nlev <- 2*2 
rmin <- 5
rmax <- 18
nreps <- c(rmin:rmax)
power <- Fpower1(alpha, nlev, nreps, Delta, sigma) 
options(digits = 5)
power
```
Para ver una diferencia significativa con una potencia del 80% necesitar√≠amos 18 r√©plicas.

Puesto que hay tres bloques, cada bloque tendr√° que repetir cada  cruce de factores 6 veces.


## ANOVA

En primer lugar, cargamos los datos

```{r}
palabras <- read.csv2("data.csv", header = TRUE, sep = ";")
piloto$Individual <- as.factor(piloto$Individual)
piloto$Device <- as.factor(piloto$Device)
piloto$Type <- as.factor(piloto$Type)
```

Realizamos el ANOVA a partir del modelo propuesto.

```{r}
palabras.aov <- aov(Count ~ Device + Type, data = palabras)
summary(palabras.aov)
```

Comprobamos las condiciones de aplicabilidad.

```{r}
par(mfrow = c(2,2))
plot(palabras.aov)
```

## Estimaci√≥n de par√°metros del modelo

```{r}
mu <- mean(palabras$Count); mu
model.tables(palabras.aov)
```

## An√°lisis post

```{r}
palabras.tukey <- TukeyHSD(palabras.tukey, ordered = T, which = "matriz")
palabras.tukey
```



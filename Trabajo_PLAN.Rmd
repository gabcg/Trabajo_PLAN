---
title: "PLAN"
author: "Gabriel Carbonell, Eduardo Rodríguez, Lucas Naranjo García"
date: "7/3/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(daewr)
```

## Introducción

## Cálculo de potencia 

Realizamos un experimento piloto con tres réplicas iniciales. Cada réplica pertenece a un bloque. Cargamos los datos:

```{r}
piloto <- read.csv2("/Users/Lucas/downloads/piloto.csv", header = TRUE, sep = ";")
piloto$Individual <- as.factor(piloto$Individual)
piloto$Device <- as.factor(piloto$Device)
piloto$Type <- as.factor(piloto$Type)
```

A continuación, realizamos el cálculo de potencia. En primer lugar calculamos el $\Delta$:

```{r}
piloto.aov <- aov(Count ~ Individual + Device * Type, data = piloto)
summary(piloto.aov)
```

Usamos el $\sigma = \sqrt{mmE}$ para realizar el cálculo de potencia.

#Número de réplicas para efectos principales:
Queremos detectar los efectos principales del dispositivo (2 niveles) y la visibilidad (2 niveles) para $\Delta = 5$ y $\sigma = 5.24$ ($\sqrt{mmE}$)

```{r}
sigma <- sqrt(27.42) ; 
alpha <- .05; 
Delta <- 6; 
nlev <- c(2,2) 
rmin <- 2; 
rmax <- 9; 
nreps <- c(rmin:rmax)
### <b>
power <- Fpower2(alpha, nlev, nreps, Delta, sigma) ### </b>
options(digits = 5)
power
```

#Número de réplicas para interacciones:

Queremos detectar interacciones entre el dispositivo  (2 niveles) y la viibilidad (2 niveles), con $\Delta = 6$ y suponiendo $\sigma = 5.24$ (lo tratamos como ANOVA de un factor con 2x2=4 niveles):

```{r}
sigma <- sqrt(27.42) 
alpha <- .05
Delta <- 6
nlev <- 2*2 
rmin <- 5
rmax <- 18
nreps <- c(rmin:rmax)
power <- Fpower1(alpha, nlev, nreps, Delta, sigma) 
options(digits = 5)
power
```

Para ver una diferencia significativa con una potencia del 80% necesitaríamos 18 réplicas.

Puesto que hay tres bloques, cada bloque tendrá que repetir cada  cruce de factores 6 veces.

## ANOVA

En primer lugar, cargamos los datos.

```{r}
palabras <- read.csv2("data.csv", header = TRUE, sep = ";")
piloto$Individual <- as.factor(piloto$Individual)
piloto$Device <- as.factor(piloto$Device)
piloto$Type <- as.factor(piloto$Type)
```

Realizamos el ANOVA a partir del modelo propuesto.

```{r}
palabras.aov <- aov(Count ~ Device + Type, data = palabras)
summary(palabras.aov)
```

Comprobamos las condiciones de aplicabilidad.

```{r}
par(mfrow = c(2,2))
plot(palabras.aov)
```

## Estimación de parámetros del modelo

```{r}
mu <- mean(palabras$Count); mu
model.tables(palabras.aov)
```

## Análisis post

```{r}
palabras.tukey <- TukeyHSD(palabras.tukey, ordered = T, which = "matriz")
palabras.tukey
```


